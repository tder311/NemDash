"""Sample NEM PASA CSV content for testing"""
import io
import zipfile

# PDPASA REGIONSOLUTION format (based on actual NEMWEB structure)
SAMPLE_PDPASA_CSV = b'''C,NEMP.WORLD,,PDPASA,1
I,PDPASA,REGIONSOLUTION,2,RUN_DATETIME,INTERVAL_DATETIME,REGIONID,DEMAND10,DEMAND50,DEMAND90,RESERVEREQ,CAPACITYREQ,AGGREGATECAPACITYAVAILABLE,AGGREGATEPASAAVAILABILITY,SURPLUSRESERVE,LORCONDITION,CALCULATEDLOR1LEVEL,CALCULATEDLOR2LEVEL
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 10:30:00",NSW1,7200,7500,7800,1500,9000,10500,10000,1500,0,2000,1500
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 10:30:00",VIC1,4800,5200,5600,1200,6400,7500,7200,1100,0,1800,1400
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 10:30:00",QLD1,6300,6800,7300,1400,8200,9000,8800,800,1,1600,1300
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 10:30:00",SA1,1900,2100,2300,800,2900,3200,3100,300,2,1200,1000
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 10:30:00",TAS1,1000,1200,1400,600,1800,2000,1900,200,0,900,700
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 11:00:00",NSW1,7300,7600,7900,1500,9100,10600,10100,1500,0,2000,1500
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 11:00:00",VIC1,4900,5300,5700,1200,6500,7600,7300,1100,0,1800,1400
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 11:00:00",QLD1,6400,6900,7400,1400,8300,9100,8900,800,1,1600,1300
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 11:00:00",SA1,2000,2200,2400,800,3000,3300,3200,300,0,1200,1000
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 11:00:00",TAS1,1100,1300,1500,600,1900,2100,2000,200,0,900,700
C,END OF REPORT,,,
'''

# STPASA REGIONSOLUTION format
SAMPLE_STPASA_CSV = b'''C,NEMP.WORLD,,STPASA,1
I,STPASA,REGIONSOLUTION,3,RUN_DATETIME,INTERVAL_DATETIME,REGIONID,DEMAND10,DEMAND50,DEMAND90,RESERVEREQ,CAPACITYREQ,AGGREGATECAPACITYAVAILABLE,AGGREGATEPASAAVAILABILITY,SURPLUSRESERVE,LORCONDITION,CALCULATEDLOR1LEVEL,CALCULATEDLOR2LEVEL
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/16 00:00:00",NSW1,6800,7100,7400,1500,8600,10200,9800,1600,0,2000,1500
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/16 00:00:00",VIC1,4500,4900,5300,1200,6100,7200,6900,1100,0,1800,1400
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/16 00:00:00",QLD1,6000,6500,7000,1400,7900,8800,8500,900,0,1600,1300
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/16 00:00:00",SA1,1800,2000,2200,800,2800,3100,3000,300,0,1200,1000
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/16 00:00:00",TAS1,900,1100,1300,600,1700,1900,1800,200,0,900,700
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/17 00:00:00",NSW1,7000,7300,7600,1500,8800,10400,10000,1600,0,2000,1500
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/17 00:00:00",VIC1,4700,5100,5500,1200,6300,7400,7100,1100,0,1800,1400
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/17 00:00:00",QLD1,6200,6700,7200,1400,8100,9000,8700,900,0,1600,1300
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/17 00:00:00",SA1,1900,2100,2300,800,2900,3200,3100,300,0,1200,1000
D,STPASA,REGIONSOLUTION,3,"2025/01/15 06:00:00","2025/01/17 00:00:00",TAS1,1000,1200,1400,600,1800,2000,1900,200,0,900,700
C,END OF REPORT,,,
'''

# PASA CSV with no REGIONSOLUTION records
SAMPLE_PASA_NO_RECORDS = b'''C,NEMP.WORLD,,PDPASA,1
I,PDPASA,OTHERDATA,1,COL1,COL2,COL3
D,PDPASA,OTHERDATA,1,val1,val2,val3
C,END OF REPORT,,,
'''

# PASA with LOR3 condition (severe)
SAMPLE_PDPASA_LOR3_CSV = b'''C,NEMP.WORLD,,PDPASA,1
I,PDPASA,REGIONSOLUTION,2,RUN_DATETIME,INTERVAL_DATETIME,REGIONID,DEMAND10,DEMAND50,DEMAND90,RESERVEREQ,CAPACITYREQ,AGGREGATECAPACITYAVAILABLE,AGGREGATEPASAAVAILABILITY,SURPLUSRESERVE,LORCONDITION,CALCULATEDLOR1LEVEL,CALCULATEDLOR2LEVEL
D,PDPASA,REGIONSOLUTION,2,"2025/01/15 10:00:00","2025/01/15 10:30:00",SA1,2500,2800,3100,800,3600,2900,2800,-700,3,1200,1000
C,END OF REPORT,,,
'''

# Directory listings
SAMPLE_PDPASA_DIR = '''<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html><body>
<a href="PUBLIC_PDPASA_202501150800_00000001.zip">file1</a>
<a href="PUBLIC_PDPASA_202501150830_00000002.zip">file2</a>
<a href="PUBLIC_PDPASA_202501150900_00000003.zip">file3</a>
<a href="PUBLIC_PDPASA_202501150930_00000004.zip">file4</a>
<a href="PUBLIC_PDPASA_202501151000_00000005.zip">file5</a>
</body></html>'''

SAMPLE_STPASA_DIR = '''<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html><body>
<a href="PUBLIC_STPASA_202501150600_00000001.zip">file1</a>
<a href="PUBLIC_STPASA_202501151200_00000002.zip">file2</a>
</body></html>'''

# Empty directory
SAMPLE_PASA_EMPTY_DIR = '''<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html><body><p>No files available</p></body></html>'''


def create_pasa_zip(csv_content: bytes, pasa_type: str = 'PDPASA') -> bytes:
    """Create a sample PASA ZIP file for testing.

    Args:
        csv_content: CSV content as bytes
        pasa_type: 'PDPASA' or 'STPASA'

    Returns:
        ZIP file content as bytes
    """
    buffer = io.BytesIO()
    with zipfile.ZipFile(buffer, 'w', zipfile.ZIP_DEFLATED) as zf:
        if pasa_type == 'PDPASA':
            zf.writestr('PUBLIC_PDPASA_202501151000.CSV', csv_content)
        else:
            zf.writestr('PUBLIC_STPASA_202501150600.CSV', csv_content)
    return buffer.getvalue()
